<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Pixel 1 - Arcade (quadrati)</title>
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  html, body {
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: transparent;
  }

  body {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .pixel-canvas {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
  }

  /* Layout: 3 colonne × 5 righe → celle quadrate */
  .pixel-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(5, 1fr);
    width: 90px;
    height: 150px;
    background: transparent;
  }

  /* Pixel quadrato, nessuna interpolazione */
  .pixel {
    width: 100%;
    height: 100%;
    background: transparent;
  }

  .on {
    background: #f20050;
  }
</style>
</head>
<body>
  <div class="pixel-canvas">
    <div class="pixel-grid" id="pixelGrid">
      <!-- RIGA 1 -->
      <div class="pixel"></div><div class="pixel" data-order="1"></div><div class="pixel"></div>
      <!-- RIGA 2 -->
      <div class="pixel" data-order="2-left"></div><div class="pixel" data-order="2"></div><div class="pixel"></div>
      <!-- RIGA 3 -->
      <div class="pixel"></div><div class="pixel" data-order="3"></div><div class="pixel"></div>
      <!-- RIGA 4 -->
      <div class="pixel"></div><div class="pixel" data-order="4"></div><div class="pixel"></div>
      <!-- RIGA 5 -->
      <div class="pixel"></div><div class="pixel" data-order="5"></div><div class="pixel"></div>
    </div>
  </div>

<script>
(function() {
  const appearDur = 1000, pause = 200, disappearDur = 1000;
  const animationCycle = appearDur + pause + disappearDur; // 2200ms
  const delayBetweenNumbers = 0; // No delay between numbers
  const totalSequence = (animationCycle * 3) + (delayBetweenNumbers * 2); // Total time for all 3 animations

  const grid = document.getElementById('pixelGrid');
  const all = Array.from(grid.querySelectorAll('[data-order]'));
  const ordered = all.map(p => ({ el: p, order: parseInt(p.dataset.order) || 0 }))
                     .sort((a,b)=>a.order-b.order)
                     .map(x=>x.el);

  function runCycle() {
    ordered.forEach((el,i)=>{
      setTimeout(()=>el.classList.add('on'), (appearDur/ordered.length)*i);
      setTimeout(()=>el.classList.remove('on'),
        appearDur + pause + (disappearDur/ordered.length)*i);
    });
  }

  function startAnimation() {
    runCycle();
    setInterval(runCycle, totalSequence);
  }

  // Wait for message from parent to start
  window.addEventListener('message', (event) => {
    if (event.data === 'start') {
      startAnimation();
    }
  });
})();
</script>
</body>
</html>